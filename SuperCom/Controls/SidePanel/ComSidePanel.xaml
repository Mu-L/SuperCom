<UserControl
    x:Class="SuperCom.Controls.ComSidePanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
    xmlns:config="clr-namespace:SuperCom.Config"
    xmlns:converter="clr-namespace:SuperCom.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:diag="clr-namespace:System.Diagnostics;assembly=WindowsBase"
    xmlns:local="clr-namespace:SuperCom.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:super="https://github.com/SuperStudio/SuperControls"
    d:DesignHeight="450"
    d:DesignWidth="400"
    mc:Ignorable="d">
    <Grid>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0" Orientation="Horizontal">
                <super:HoverPath
                    Margin="5"
                    Click="RefreshPortsStatus"
                    Style="{StaticResource RefreshHoverPath}" />
                <super:HoverPath
                    Margin="5"
                    MenuOnLeftClick="True"
                    Style="{StaticResource ToolsHoverPath}">
                    <super:HoverPath.ContextMenu>
                        <ContextMenu HorizontalOffset="-50">
                            <MenuItem Click="OpenAllPort" Header="{DynamicResource OpenAllPort}" />
                            <MenuItem Click="CloseAllPort" Header="{DynamicResource CloseAllPort}" />
                            <MenuItem Click="ShowAllHidePort" Header="{DynamicResource ShowHidePort}" />
                        </ContextMenu>
                    </super:HoverPath.ContextMenu>
                </super:HoverPath>

                <super:HoverPath Style="{StaticResource SortHoverPath}">
                    <super:HoverPath.ContextMenu>
                        <ContextMenu HorizontalOffset="-50">

                            <MenuItem
                                super:MenuItemExt.Desc="True"
                                super:MenuItemExt.Sortable="True"
                                Click="SortSidePorts"
                                Header="{DynamicResource SortByAddDate}"
                                Style="{StaticResource SortMenuItemStyle}"
                                Tag="AddTime" />
                            <MenuItem
                                Click="SortSidePorts"
                                Header="{DynamicResource SortByName}"
                                Style="{StaticResource SortMenuItemStyle}"
                                Tag="PortName" />
                        </ContextMenu>
                    </super:HoverPath.ContextMenu>
                </super:HoverPath>
            </StackPanel>
            <ScrollViewer Grid.Row="1">
                <StackPanel Orientation="Vertical">
                    <ListBox
                        HorizontalContentAlignment="Stretch"
                        d:ItemsSource="{d:SampleData ItemCount=5}"
                        Background="Transparent"
                        ItemsSource="{Binding SideComPorts}"
                        ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                        Style="{StaticResource NormalListBox}">
                        <ListBox.ItemContainerStyle>
                            <Style BasedOn="{StaticResource BaseListBoxItem}" TargetType="{x:Type ListBoxItem}">
                                <Setter Property="Padding" Value="0" />
                                <Setter Property="Background" Value="Transparent" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Hide}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBox}}, Path=ActualWidth, Converter={StaticResource WidthConverter}, ConverterParameter=-15}"
                                    Margin="0,2"
                                    Background="{DynamicResource ListBoxItem.Background}"
                                    CornerRadius="5">
                                    <Grid
                                        Background="Transparent"
                                        PreviewMouseLeftButtonDown="Grid_PreviewMouseLeftButtonDown"
                                        Tag="{Binding Name}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition Width="auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="auto" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem
                                                    Click="Remark"
                                                    Header="{DynamicResource Remark}"
                                                    Icon="/Resources/Pictures/remark.png" />
                                                <MenuItem Click="HidePort" Header="{DynamicResource Hide}" />
                                            </ContextMenu>
                                        </Grid.ContextMenu>
                                        <Border
                                            Grid.Column="0"
                                            Width="10"
                                            Height="10"
                                            Margin="5"
                                            CornerRadius="10">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Background" Value="Green" />
                                                    <Style.Triggers>

                                                        <DataTrigger Binding="{Binding Connected}" Value="True">
                                                            <Setter Property="Background" Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                        </Border>
                                        <TextBlock
                                            Grid.Column="1"
                                            MaxWidth="120"
                                            Margin="0"
                                            Padding="10,5"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            Style="{StaticResource BaseTextBlock}"
                                            Text="{Binding Name}"
                                            TextTrimming="WordEllipsis"
                                            TextWrapping="WrapWithOverflow"
                                            ToolTip="{Binding Detail}" />
                                        <Border
                                            Grid.Column="2"
                                            Margin="0,0,5,0"
                                            Padding="5,3"
                                            VerticalAlignment="Center"
                                            CornerRadius="4">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                    <Style.Triggers>

                                                        <DataTrigger Binding="{Binding PortType}" Value="Virtual">
                                                            <Setter Property="ToolTip" Value="{DynamicResource VirtualPort}" />
                                                            <Setter Property="Background" Value="{DynamicResource Common.HighLight.Deep.Background}" />
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding PortType}" Value="USBSerial">
                                                            <Setter Property="ToolTip" Value="USB-Serial" />
                                                            <Setter Property="Background" Value="{DynamicResource Common.HighLight.BorderBrush}" />
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding PortType}" Value="BLE">
                                                            <Setter Property="ToolTip" Value="BLE" />
                                                            <Setter Property="Background" Value="{DynamicResource Control.Disabled.Background}" />
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>

                                                        <DataTrigger Binding="{Binding Path=ShowPortType, Source={x:Static config:ConfigManager.Settings}, Mode=OneWay}" Value="False">
                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>

                                            <TextBlock Margin="0" FontSize="7">
                                                <TextBlock.Style>
                                                    <Style BasedOn="{StaticResource BaseTextBlock}" TargetType="TextBlock">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding PortType}" Value="Virtual">
                                                                <Setter Property="Text" Value="V" />
                                                                <Setter Property="ToolTip" Value="{DynamicResource VirtualPort}" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding PortType}" Value="USBSerial">
                                                                <Setter Property="Text" Value="U" />
                                                                <Setter Property="ToolTip" Value="USB-Serial" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding PortType}" Value="BLE">
                                                                <Setter Property="Text" Value="B" />
                                                                <Setter Property="ToolTip" Value="BLE" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </Border>
                                        <TextBlock
                                            Grid.Column="3"
                                            Margin="0"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Center"
                                            FontSize="12"
                                            Foreground="{DynamicResource Window.Sub.Foreground}"
                                            Style="{StaticResource BaseTextBlock}"
                                            Text="{Binding Remark, UpdateSourceTrigger=PropertyChanged}"
                                            TextTrimming="WordEllipsis"
                                            TextWrapping="NoWrap" />
                                        <Button
                                            Grid.Column="4"
                                            Margin="5"
                                            HorizontalAlignment="Right"
                                            Click="ConnectPort"
                                            Tag="{Binding Name}">
                                            <Button.Style>
                                                <Style BasedOn="{StaticResource FillButton}" TargetType="Button">
                                                    <Setter Property="Content" Value="{DynamicResource Connect}" />
                                                    <Setter Property="Visibility" Value="Hidden" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Connected}" Value="True">
                                                            <Setter Property="Content" Value="{DynamicResource Disconnect}" />
                                                            <Setter Property="Background" Value="Red" />
                                                            <Setter Property="super:CommonExt.HoverBackground" Value="Red" />
                                                        </DataTrigger>

                                                        <DataTrigger Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type Grid}, Mode=FindAncestor}}" Value="true">
                                                            <Setter Property="Visibility" Value="Visible" />
                                                        </DataTrigger>

                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!--</Expander>-->
                    <Expander
                        Foreground="{DynamicResource Window.Foreground}"
                        Header="Telnet"
                        Visibility="Collapsed">
                        <TextBlock Text="192.168.3.1" />
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</UserControl>
